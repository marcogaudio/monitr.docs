<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute optimal exposure — optimize_exposure • monitr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute optimal exposure — optimize_exposure" />
<meta property="og:description" content="The idea behind this function is to compute in an optimal way the exposure period
for each policyhoder and for each year in which the contract is in force, by distinguishing
each calendar year in before and after his/her birthday. Doing so, for a given policyholder
and for each year we get the exposure he/she is exposed with age x and the exposure he/she
is exposed at age x+1." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">monitr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignette
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/monitr.html">Introduction to monitr</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/marcogaudio/monitr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute optimal exposure</h1>
    <small class="dont-index">Source: <a href='https://github.com/marcogaudio/monitr/blob/master/R/optimize_exposure.R'><code>R/optimize_exposure.R</code></a></small>
    <div class="hidden name"><code>optimize_exposure.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The idea behind this function is to compute in an optimal way the exposure period
for each policyhoder and for each year in which the contract is in force, by distinguishing
each calendar year in before and after his/her birthday. Doing so, for a given policyholder
and for each year we get the exposure he/she is exposed with age x and the exposure he/she
is exposed at age x+1.</p>
    </div>

    <pre class="usage"><span class='fu'>optimize_exposure</span><span class='op'>(</span>
  <span class='va'>.data</span>,
  <span class='va'>.polnr</span>,
  <span class='va'>.inceptiondate</span>,
  <span class='va'>.termdate</span>,
  <span class='va'>.mainevent</span>,
  <span class='va'>.mainevent_date</span>,
  <span class='va'>.subevent</span>,
  <span class='va'>.subevent_date</span>,
  <span class='va'>.birthdate</span>,
  <span class='va'>.gender</span>,
  .waitingperiod <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.data</th>
      <td><p>A data frame of insurance policies that has a number of rows for each policy equal to:
year in force of the policy x 2. This type of format is required to compute in an optimal
way the exposure in each calendar year for each age of the policyholder.</p></td>
    </tr>
    <tr>
      <th>.polnr</th>
      <td><p>A column of .data with the policy identification numbers.</p></td>
    </tr>
    <tr>
      <th>.inceptiondate</th>
      <td><p>A column of .data with the starting date of the policies.</p></td>
    </tr>
    <tr>
      <th>.termdate</th>
      <td><p>A column of .data with the expiry date of the policies.</p></td>
    </tr>
    <tr>
      <th>.mainevent</th>
      <td><p>A column of .data with 1 if the main event (the one for which perform the monitoring) occurred, 0 otherwise.</p></td>
    </tr>
    <tr>
      <th>.mainevent_date</th>
      <td><p>A column of .data with the date of the event (claim or lapse) for which the monitoring has to be performed.
For policy  with no claim/lapse the date should be 2099-12-31.</p></td>
    </tr>
    <tr>
      <th>.subevent</th>
      <td><p>A column of .data with 1 if the sub event (the one for which do not perform the monitoring) occurred, 0 otherwise.</p></td>
    </tr>
    <tr>
      <th>.subevent_date</th>
      <td><p>A column of .data with the date of the subordinate event (claim or lapse). In this case, for this event the monitoring
is not performed. For policies with no claim/lapse the date should be 2099-12-31.</p></td>
    </tr>
    <tr>
      <th>.birthdate</th>
      <td><p>A column of .data with the birthday of the policyholders.</p></td>
    </tr>
    <tr>
      <th>.gender</th>
      <td><p>A column of .data with the gender of the policyholders.</p></td>
    </tr>
    <tr>
      <th>.waitingperiod</th>
      <td><p>A column with the waiting period (in months) for the policy.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The modified data frame with some new columns, in particular:</p><ul>
<li><p><code>inception_valuation_date</code> indicates the date from which to start to compute the exposure,
it can be the inception date, the renewal date or the first of January of the current year;</p></li>
<li><p><code>end_valuation_date</code> indicates the ending date to take into account in the computation of
the exposure, it can be the last day of the current year, the claim/lapse date or the renewal
date (this because in the following row the inception_valuation_date will be the same);</p></li>
<li><p><code>AGE0</code> is the age of the policyholder at the inception valuation date;</p></li>
<li><p><code>AGE1</code> is the possible age of the policyholder at the end valuation date;</p></li>
<li><p><code>DAY_AGE0</code> indicates the day of exposure of the policyholder with <code>AGE0</code>(before his/her anniversary)
in the valuation period;</p></li>
<li><p><code>DAY_AGE1</code> indicates the day of exposure of the policyholder with <code>AGE1</code> (after his/her anniversary)
in the valuation period;</p></li>
<li><p><code>EXPOSURE_YEAR_AGE0</code> is the exposure of the policyholder in the current year when he/she has <code>AGE0</code>,
(it is computed as number days exposed with age0 / total number of days in the current year);</p></li>
<li><p><code>EXPOSURE_YEAR_AGE1</code> is the exposure of the policyholder in the current year when he/she has <code>AGE1</code>,
(it is computed as number days exposed with age1 / total number of days in the current year);</p></li>
<li><p><code>EXPOSURE_IN_YEAR</code> is the total exposure in the valuation period, the sum of the previous two exposures,
it is 1 by definition when a main event (claim/lapse) occurs.</p></li>
</ul>

<p><a href='https://lifecycle.r-lib.org/articles/stages.html#experimental'><img src='figures/lifecycle-experimental.svg' alt='[Experimental]' /></a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>lifepolicies</span><span class='op'>)</span>
<span class='va'>lifepolicies</span> <span class='op'>%&gt;%</span>
  <span class='fu'>optimize_exposure</span><span class='op'>(</span>
  .polnr <span class='op'>=</span> <span class='va'>Policy_id</span>, .inceptiondate <span class='op'>=</span> <span class='va'>Inception_date</span>,
  .termdate <span class='op'>=</span> <span class='va'>Term_date</span>, .mainevent <span class='op'>=</span> <span class='va'>Claim</span> , .mainevent_date <span class='op'>=</span> <span class='va'>Claim_date</span>,
  .subevent <span class='op'>=</span> <span class='va'>Lapse</span>, .subevent_date <span class='op'>=</span> <span class='va'>Lapse_date</span>, .birthdate <span class='op'>=</span> <span class='va'>Birth_date</span>,
  .gender <span class='op'>=</span> <span class='va'>Gender</span>, .waitingperiod <span class='op'>=</span> <span class='va'>Waiting_period</span>
  <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: There are policies which main event occurs in the waiting period: c(1046726, 1355512, 1807138, 2560830, 2759498, 3451651, 4017689, 4947699, 5141288, 5194342, 5461098, 6020022, 6518108, 7231957, 7263230, 7278494, 9169837, 9409256)</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are policies which sub event occurs in the waiting period: c(1425221, 2293556, 2713558, 3088353, 4809645, 5575964, 6504789, 6572333, 6793280, 7869755, 7950721, 9603585)</span></div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 28,514 x 21</span><span>
#&gt;    Policy_id Inception_date Term_date  Birth_date Gender    UY    CY
#&gt;        </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;date&gt;</span><span>         </span><span style='color: #949494;font-style: italic;'>&lt;date&gt;</span><span>     </span><span style='color: #949494;font-style: italic;'>&lt;date&gt;</span><span>     </span><span style='color: #949494;font-style: italic;'>&lt;chr&gt;</span><span>  </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'> 1</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>012
#&gt; </span><span style='color: #BCBCBC;'> 2</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>013
#&gt; </span><span style='color: #BCBCBC;'> 3</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>013
#&gt; </span><span style='color: #BCBCBC;'> 4</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>014
#&gt; </span><span style='color: #BCBCBC;'> 5</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>014
#&gt; </span><span style='color: #BCBCBC;'> 6</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>015
#&gt; </span><span style='color: #BCBCBC;'> 7</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>015
#&gt; </span><span style='color: #BCBCBC;'> 8</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>016
#&gt; </span><span style='color: #BCBCBC;'> 9</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>016
#&gt; </span><span style='color: #BCBCBC;'>10</span><span>   1</span><span style='text-decoration: underline;'>019</span><span>640 2012-11-01     2016-11-01 1945-03-10 F       </span><span style='text-decoration: underline;'>2</span><span>012  </span><span style='text-decoration: underline;'>2</span><span>017
#&gt; </span><span style='color: #949494;'># ... with 28,504 more rows, and 14 more variables: policy_duration &lt;dbl&gt;,</span><span>
#&gt; </span><span style='color: #949494;'>#   Claim_date &lt;date&gt;, Claim &lt;dbl&gt;, Lapse_date &lt;date&gt;, Lapse &lt;dbl&gt;,</span><span>
#&gt; </span><span style='color: #949494;'>#   inception_valuation_date &lt;date&gt;, end_valuation_date &lt;date&gt;, AGE0 &lt;dbl&gt;,</span><span>
#&gt; </span><span style='color: #949494;'>#   AGE1 &lt;dbl&gt;, DAY_AGE0 &lt;dbl&gt;, DAY_AGE1 &lt;dbl&gt;, EXPOSURE_YEAR_AGE0 &lt;dbl&gt;,</span><span>
#&gt; </span><span style='color: #949494;'>#   EXPOSURE_YEAR_AGE1 &lt;dbl&gt;, EXPOSURE_IN_YEAR &lt;dbl&gt;</span><span></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Luigi Aceto, Marco Gaudio.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


